# !/bin/bash
# OSDiscovery
# Audit lab 3
# tool to find an OS of a remote host

#iterate through the file of IP addresses
for i in $(cat < "$1");
do
    #define variables for various TTLs
    TTLWin="ttl=128" #Windows
    TTLFBSD="ttl=64" #FreeBSD
    TTLLin="ttl=255" #Linux

    #ping the host and store teh output
    output=$(ping $i -c 1)

    #iterate throught the output of the ping, searching for a matching TTL
    for result in $output
    do
        #check if TTL matches Windows Variable
        if [ "$result" = "$TTLWin" ];then
                echo $i is a Windows box

            fi
        #check if TTL matches Linux Variable
        if [ "$result" = "$TTLLin" ];then
                echo $i is a Linux box

        fi
        #Check if TTL matches freeBSD variable
        if [ "$result" = "$TTLFBSD" ];then
                echo $i is a freeBSD box
        fi
    done

